-- Copyright (c) 2022, Oracle and/or its affiliates.
-- Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/

\sql
SET GLOBAL local_infile = 1;
DROP DATABASE IF EXISTS heatwaveml_bench;
CREATE DATABASE heatwaveml_bench;
USE heatwaveml_bench;

CREATE TABLE `cnae-9_train` (V1 INT, V2 INT, V3 INT, V4 INT, V5 INT, V6 INT, V7 INT, V8 INT, V9 INT, V10 INT, V11 INT, V12 INT, V13 INT, V14 INT, V15 INT, V16 INT, V17 INT, V18 INT, V19 INT, V20 INT, V21 INT, V22 INT, V23 INT, V24 INT, V25 INT, V26 INT, V27 INT, V28 INT, V29 INT, V30 INT, V31 INT, V32 INT, V33 INT, V34 INT, V35 INT, V36 INT, V37 INT, V38 INT, V39 INT, V40 INT, V41 INT, V42 INT, V43 INT, V44 INT, V45 INT, V46 INT, V47 INT, V48 INT, V49 INT, V50 INT, V51 INT, V52 INT, V53 INT, V54 INT, V55 INT, V56 INT, V57 INT, V58 INT, V59 INT, V60 INT, V61 INT, V62 INT, V63 INT, V64 INT, V65 INT, V66 INT, V67 INT, V68 INT, V69 INT, V70 INT, V71 INT, V72 INT, V73 INT, V74 INT, V75 INT, V76 INT, V77 INT, V78 INT, V79 INT, V80 INT, V81 INT, V82 INT, V83 INT, V84 INT, V85 INT, V86 INT, V87 INT, V88 INT, V89 INT, V90 INT, V91 INT, V92 INT, V93 INT, V94 INT, V95 INT, V96 INT, V97 INT, V98 INT, V99 INT, V100 INT, V101 INT, V102 INT, V103 INT, V104 INT, V105 INT, V106 INT, V107 INT, V108 INT, V109 INT, V110 INT, V111 INT, V112 INT, V113 INT, V114 INT, V115 INT, V116 INT, V117 INT, V118 INT, V119 INT, V120 INT, V121 INT, V122 INT, V123 INT, V124 INT, V125 INT, V126 INT, V127 INT, V128 INT, V129 INT, V130 INT, V131 INT, V132 INT, V133 INT, V134 INT, V135 INT, V136 INT, V137 INT, V138 INT, V139 INT, V140 INT, V141 INT, V142 INT, V143 INT, V144 INT, V145 INT, V146 INT, V147 INT, V148 INT, V149 INT, V150 INT, V151 INT, V152 INT, V153 INT, V154 INT, V155 INT, V156 INT, V157 INT, V158 INT, V159 INT, V160 INT, V161 INT, V162 INT, V163 INT, V164 INT, V165 INT, V166 INT, V167 INT, V168 INT, V169 INT, V170 INT, V171 INT, V172 INT, V173 INT, V174 INT, V175 INT, V176 INT, V177 INT, V178 INT, V179 INT, V180 INT, V181 INT, V182 INT, V183 INT, V184 INT, V185 INT, V186 INT, V187 INT, V188 INT, V189 INT, V190 INT, V191 INT, V192 INT, V193 INT, V194 INT, V195 INT, V196 INT, V197 INT, V198 INT, V199 INT, V200 INT, V201 INT, V202 INT, V203 INT, V204 INT, V205 INT, V206 INT, V207 INT, V208 INT, V209 INT, V210 INT, V211 INT, V212 INT, V213 INT, V214 INT, V215 INT, V216 INT, V217 INT, V218 INT, V219 INT, V220 INT, V221 INT, V222 INT, V223 INT, V224 INT, V225 INT, V226 INT, V227 INT, V228 INT, V229 INT, V230 INT, V231 INT, V232 INT, V233 INT, V234 INT, V235 INT, V236 INT, V237 INT, V238 INT, V239 INT, V240 INT, V241 INT, V242 INT, V243 INT, V244 INT, V245 INT, V246 INT, V247 INT, V248 INT, V249 INT, V250 INT, V251 INT, V252 INT, V253 INT, V254 INT, V255 INT, V256 INT, V257 INT, V258 INT, V259 INT, V260 INT, V261 INT, V262 INT, V263 INT, V264 INT, V265 INT, V266 INT, V267 INT, V268 INT, V269 INT, V270 INT, V271 INT, V272 INT, V273 INT, V274 INT, V275 INT, V276 INT, V277 INT, V278 INT, V279 INT, V280 INT, V281 INT, V282 INT, V283 INT, V284 INT, V285 INT, V286 INT, V287 INT, V288 INT, V289 INT, V290 INT, V291 INT, V292 INT, V293 INT, V294 INT, V295 INT, V296 INT, V297 INT, V298 INT, V299 INT, V300 INT, V301 INT, V302 INT, V303 INT, V304 INT, V305 INT, V306 INT, V307 INT, V308 INT, V309 INT, V310 INT, V311 INT, V312 INT, V313 INT, V314 INT, V315 INT, V316 INT, V317 INT, V318 INT, V319 INT, V320 INT, V321 INT, V322 INT, V323 INT, V324 INT, V325 INT, V326 INT, V327 INT, V328 INT, V329 INT, V330 INT, V331 INT, V332 INT, V333 INT, V334 INT, V335 INT, V336 INT, V337 INT, V338 INT, V339 INT, V340 INT, V341 INT, V342 INT, V343 INT, V344 INT, V345 INT, V346 INT, V347 INT, V348 INT, V349 INT, V350 INT, V351 INT, V352 INT, V353 INT, V354 INT, V355 INT, V356 INT, V357 INT, V358 INT, V359 INT, V360 INT, V361 INT, V362 INT, V363 INT, V364 INT, V365 INT, V366 INT, V367 INT, V368 INT, V369 INT, V370 INT, V371 INT, V372 INT, V373 INT, V374 INT, V375 INT, V376 INT, V377 INT, V378 INT, V379 INT, V380 INT, V381 INT, V382 INT, V383 INT, V384 INT, V385 INT, V386 INT, V387 INT, V388 INT, V389 INT, V390 INT, V391 INT, V392 INT, V393 INT, V394 INT, V395 INT, V396 INT, V397 INT, V398 INT, V399 INT, V400 INT, V401 INT, V402 INT, V403 INT, V404 INT, V405 INT, V406 INT, V407 INT, V408 INT, V409 INT, V410 INT, V411 INT, V412 INT, V413 INT, V414 INT, V415 INT, V416 INT, V417 INT, V418 INT, V419 INT, V420 INT, V421 INT, V422 INT, V423 INT, V424 INT, V425 INT, V426 INT, V427 INT, V428 INT, V429 INT, V430 INT, V431 INT, V432 INT, V433 INT, V434 INT, V435 INT, V436 INT, V437 INT, V438 INT, V439 INT, V440 INT, V441 INT, V442 INT, V443 INT, V444 INT, V445 INT, V446 INT, V447 INT, V448 INT, V449 INT, V450 INT, V451 INT, V452 INT, V453 INT, V454 INT, V455 INT, V456 INT, V457 INT, V458 INT, V459 INT, V460 INT, V461 INT, V462 INT, V463 INT, V464 INT, V465 INT, V466 INT, V467 INT, V468 INT, V469 INT, V470 INT, V471 INT, V472 INT, V473 INT, V474 INT, V475 INT, V476 INT, V477 INT, V478 INT, V479 INT, V480 INT, V481 INT, V482 INT, V483 INT, V484 INT, V485 INT, V486 INT, V487 INT, V488 INT, V489 INT, V490 INT, V491 INT, V492 INT, V493 INT, V494 INT, V495 INT, V496 INT, V497 INT, V498 INT, V499 INT, V500 INT, V501 INT, V502 INT, V503 INT, V504 INT, V505 INT, V506 INT, V507 INT, V508 INT, V509 INT, V510 INT, V511 INT, V512 INT, V513 INT, V514 INT, V515 INT, V516 INT, V517 INT, V518 INT, V519 INT, V520 INT, V521 INT, V522 INT, V523 INT, V524 INT, V525 INT, V526 INT, V527 INT, V528 INT, V529 INT, V530 INT, V531 INT, V532 INT, V533 INT, V534 INT, V535 INT, V536 INT, V537 INT, V538 INT, V539 INT, V540 INT, V541 INT, V542 INT, V543 INT, V544 INT, V545 INT, V546 INT, V547 INT, V548 INT, V549 INT, V550 INT, V551 INT, V552 INT, V553 INT, V554 INT, V555 INT, V556 INT, V557 INT, V558 INT, V559 INT, V560 INT, V561 INT, V562 INT, V563 INT, V564 INT, V565 INT, V566 INT, V567 INT, V568 INT, V569 INT, V570 INT, V571 INT, V572 INT, V573 INT, V574 INT, V575 INT, V576 INT, V577 INT, V578 INT, V579 INT, V580 INT, V581 INT, V582 INT, V583 INT, V584 INT, V585 INT, V586 INT, V587 INT, V588 INT, V589 INT, V590 INT, V591 INT, V592 INT, V593 INT, V594 INT, V595 INT, V596 INT, V597 INT, V598 INT, V599 INT, V600 INT, V601 INT, V602 INT, V603 INT, V604 INT, V605 INT, V606 INT, V607 INT, V608 INT, V609 INT, V610 INT, V611 INT, V612 INT, V613 INT, V614 INT, V615 INT, V616 INT, V617 INT, V618 INT, V619 INT, V620 INT, V621 INT, V622 INT, V623 INT, V624 INT, V625 INT, V626 INT, V627 INT, V628 INT, V629 INT, V630 INT, V631 INT, V632 INT, V633 INT, V634 INT, V635 INT, V636 INT, V637 INT, V638 INT, V639 INT, V640 INT, V641 INT, V642 INT, V643 INT, V644 INT, V645 INT, V646 INT, V647 INT, V648 INT, V649 INT, V650 INT, V651 INT, V652 INT, V653 INT, V654 INT, V655 INT, V656 INT, V657 INT, V658 INT, V659 INT, V660 INT, V661 INT, V662 INT, V663 INT, V664 INT, V665 INT, V666 INT, V667 INT, V668 INT, V669 INT, V670 INT, V671 INT, V672 INT, V673 INT, V674 INT, V675 INT, V676 INT, V677 INT, V678 INT, V679 INT, V680 INT, V681 INT, V682 INT, V683 INT, V684 INT, V685 INT, V686 INT, V687 INT, V688 INT, V689 INT, V690 INT, V691 INT, V692 INT, V693 INT, V694 INT, V695 INT, V696 INT, V697 INT, V698 INT, V699 INT, V700 INT, V701 INT, V702 INT, V703 INT, V704 INT, V705 INT, V706 INT, V707 INT, V708 INT, V709 INT, V710 INT, V711 INT, V712 INT, V713 INT, V714 INT, V715 INT, V716 INT, V717 INT, V718 INT, V719 INT, V720 INT, V721 INT, V722 INT, V723 INT, V724 INT, V725 INT, V726 INT, V727 INT, V728 INT, V729 INT, V730 INT, V731 INT, V732 INT, V733 INT, V734 INT, V735 INT, V736 INT, V737 INT, V738 INT, V739 INT, V740 INT, V741 INT, V742 INT, V743 INT, V744 INT, V745 INT, V746 INT, V747 INT, V748 INT, V749 INT, V750 INT, V751 INT, V752 INT, V753 INT, V754 INT, V755 INT, V756 INT, V757 INT, V758 INT, V759 INT, V760 INT, V761 INT, V762 INT, V763 INT, V764 INT, V765 INT, V766 INT, V767 INT, V768 INT, V769 INT, V770 INT, V771 INT, V772 INT, V773 INT, V774 INT, V775 INT, V776 INT, V777 INT, V778 INT, V779 INT, V780 INT, V781 INT, V782 INT, V783 INT, V784 INT, V785 INT, V786 INT, V787 INT, V788 INT, V789 INT, V790 INT, V791 INT, V792 INT, V793 INT, V794 INT, V795 INT, V796 INT, V797 INT, V798 INT, V799 INT, V800 INT, V801 INT, V802 INT, V803 INT, V804 INT, V805 INT, V806 INT, V807 INT, V808 INT, V809 INT, V810 INT, V811 INT, V812 INT, V813 INT, V814 INT, V815 INT, V816 INT, V817 INT, V818 INT, V819 INT, V820 INT, V821 INT, V822 INT, V823 INT, V824 INT, V825 INT, V826 INT, V827 INT, V828 INT, V829 INT, V830 INT, V831 INT, V832 INT, V833 INT, V834 INT, V835 INT, V836 INT, V837 INT, V838 INT, V839 INT, V840 INT, V841 INT, V842 INT, V843 INT, V844 INT, V845 INT, V846 INT, V847 INT, V848 INT, V849 INT, V850 INT, V851 INT, V852 INT, V853 INT, V854 INT, V855 INT, V856 INT, Class INT);
CREATE TABLE `cnae-9_test` LIKE  `cnae-9_train`;

\js
util.importTable("cnae-9_train.csv",{table: "cnae-9_train", dialect: "csv-unix", skipRows:1})
util.importTable("cnae-9_test.csv",{table: "cnae-9_test", dialect: "csv-unix", skipRows:1})

\sql
-- Train the model
CALL sys.ML_TRAIN('heatwaveml_bench.`cnae-9_train`', 'Class', JSON_OBJECT('task', 'classification'), @model_cnae);
-- Load the model into HeatWave
CALL sys.ML_MODEL_LOAD(@model_cnae, NULL);
-- Score the model on the test data
CALL sys.ML_SCORE('heatwaveml_bench.`cnae-9_test`', 'Class', @model_cnae, 'balanced_accuracy', @score_cnae, null);
-- Print the score
SELECT @score_cnae;

DROP DATABASE heatwaveml_bench;
