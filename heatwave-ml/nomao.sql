-- Copyright (c) 2022, Oracle and/or its affiliates.
-- Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/

DROP DATABASE IF EXISTS heatwaveml_bench;
CREATE DATABASE heatwaveml_bench;
USE heatwaveml_bench;

CREATE TABLE nomao_train ( V0 VARCHAR(255), V1 FLOAT, V2 FLOAT, V3 FLOAT, V4 FLOAT, V5 FLOAT, V6 FLOAT, V7 VARCHAR(255), V8 VARCHAR(255), V9 FLOAT, V10 FLOAT, V11 FLOAT, V12 FLOAT, V13 FLOAT, V14 FLOAT, V15 VARCHAR(255), V16 VARCHAR(255), V17 FLOAT, V18 FLOAT, V19 FLOAT, V20 FLOAT, V21 FLOAT, V22 FLOAT, V23 VARCHAR(255), V24 VARCHAR(255), V25 FLOAT, V26 FLOAT, V27 FLOAT, V28 FLOAT, V29 FLOAT, V30 FLOAT, V31 VARCHAR(255), V32 VARCHAR(255), V33 FLOAT, V34 FLOAT, V35 FLOAT, V36 FLOAT, V37 FLOAT, V38 FLOAT, V39 VARCHAR(255), V40 VARCHAR(255), V41 FLOAT, V42 FLOAT, V43 FLOAT, V44 FLOAT, V45 FLOAT, V46 FLOAT, V47 VARCHAR(255), V48 VARCHAR(255), V49 FLOAT, V50 FLOAT, V51 FLOAT, V52 FLOAT, V53 FLOAT, V54 FLOAT, V55 VARCHAR(255), V56 VARCHAR(255), V57 FLOAT, V58 FLOAT, V59 FLOAT, V60 FLOAT, V61 FLOAT, V62 FLOAT, V63 VARCHAR(255), V64 VARCHAR(255), V65 FLOAT, V66 FLOAT, V67 FLOAT, V68 FLOAT, V69 FLOAT, V70 FLOAT, V71 VARCHAR(255), V72 VARCHAR(255), V73 FLOAT, V74 FLOAT, V75 FLOAT, V76 FLOAT, V77 FLOAT, V78 FLOAT, V79 VARCHAR(255), V80 VARCHAR(255), V81 FLOAT, V82 FLOAT, V83 FLOAT, V84 FLOAT, V85 FLOAT, V86 FLOAT, V87 VARCHAR(255), V88 VARCHAR(255), V89 FLOAT, V90 FLOAT, V91 FLOAT, V92 VARCHAR(255), V93 FLOAT, V94 FLOAT, V95 FLOAT, V96 VARCHAR(255), V97 FLOAT, V98 FLOAT, V99 FLOAT, V100 VARCHAR(255), V101 FLOAT, V102 FLOAT, V103 FLOAT, V104 VARCHAR(255), V105 FLOAT, V106 FLOAT, V107 FLOAT, V108 VARCHAR(255), V109 FLOAT, V110 FLOAT, V111 FLOAT, V112 VARCHAR(255), V113 FLOAT, V114 FLOAT, V115 FLOAT, V116 VARCHAR(255), V117 FLOAT, V118 FLOAT, Class VARCHAR(255));
CREATE TABLE nomao_test LIKE nomao_train;

\js
util.importTable("nomao_train.csv",{table: "nomao_train", dialect: "csv-unix", skipRows:1})
util.importTable("nomao_test.csv",{table: "nomao_test", dialect: "csv-unix", skipRows:1})

\sql
-- Train the model
CALL sys.ML_TRAIN('heatwaveml_bench.nomao_train', 'Class', JSON_OBJECT('task', 'classification'), @model);
-- Load the model into HeatWave
CALL sys.ML_MODEL_LOAD(@model, NULL);
-- Score the model on the test data
CALL sys.ML_SCORE('heatwaveml_bench.nomao_test', 'Class', @model, 'balanced_accuracy', @score);
-- Print the score
SELECT @score;

DROP DATABASE heatwaveml_bench;